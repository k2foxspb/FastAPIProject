from fastapi import FastAPI, Requestfrom fastapi.staticfiles import StaticFilesfrom starlette.templating import Jinja2Templatesfrom app.core.middleware import setup_middlewarefrom app.core.logging import setup_loggingfrom app.api.routers import api_routerfrom app.api.routers.health import router as health_routertemplates = Jinja2Templates(directory="app/templates")def create_application() -> FastAPI:    """Фабрика для создания приложения FastAPI."""    # Настройка логирования    setup_logging()    # Создание приложения    app = FastAPI(        title="FastAPI Интернет-магазин",        version="0.1.0",        description="API для интернет-магазина",        docs_url="/docs",        redoc_url="/redoc",    )    # Настройка middleware    setup_middleware(app)    # Подключение роутеров    app.include_router(health_router)    app.include_router(api_router, prefix="")    # Статические файлы    app.mount("/media", StaticFiles(directory="app/media"), name="media")    @app.get("/ws-test")    async def get_ws_test(request: Request):        return templates.TemplateResponse("ws_test.html", {"request": request})    @app.get("/chat-test")    async def get_chat_test(request: Request):        return templates.TemplateResponse("chat_test.html", {"request": request})    return app# Создание экземпляра приложенияapp = create_application()# Опционально: создание второй версии APIdef create_v2_application() -> FastAPI:    """Версия 2 API (если нужна)."""    app_v2 = FastAPI(        title="FastAPI Интернет-магазин",        version="0.2.0",        description="API для интернет-магазина v2",    )    # Настройки для v2...    return app_v2# app_v1 = create_v2_application()# app.mount('/v2', app_v1)